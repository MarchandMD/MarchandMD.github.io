---
layout: post
published: false
title: "GraphQL"
categories: graphql http apis request response
---

This article is a dialogue about GraphQL.

> Ok, but what are you gonna talk about?

How to set it up in an API-only rails app, and how to do the basic requests and responses for most CRUD functionality.

> ....

To start: What is required to set up graphQL?

> an API-only rails app

Anything else?

> nah

Alright, then let's begin.

# How to get GraphQL into a rails app

```
bundle add graphql
```

What does that do?

> From the commandline, if you're in the root folder of the rails project, that command will add this line to your projects Gemfile:
>
> ```
> gem "graphql", "~> <some_symantic_version_number_here>"
> ```

The next step would usually be to run `bundle`, but there's another Gem to add.

> The other gem to add doesn't actually have to be included.....but it makes working with graphQL super easy. So it's a good idea to use it.
>
> ```
> bundle add graphiql-rails -g 'development'
> ```
>
> This will add the `graphiql-rails` gem to the "development" group. Which means `graphiql-rails` will work in the development environment, which is localhost.

At this point, there are now 2 new gems:

1. `graphql`
2. `graphiql-rails`

These are the only gems needed for the rest of this article.

> RUN `bundle` (or `bundle install` if you like to type additional words for no reason)

The api-only rails app is now prepared to use graphql in production, development and test; It also has a neat interface available for working with graphQL in development.

# How to enable graphQL in the app, after adding the Gems

Adding those gems is like adding tools to the toolbox. Now it's time to run a command that'll do a lot of necessary things for me.

> run the following command in the commandline:
>
> ```
> rails g --help
> ```

A list of "generators" will appear. These shouldn't be intimidating. These are bunch of additional tools. Look for one that is familiar. To me, that's `rspec:install`. I've run that one before.

> Ok, now that I see a familiar one, I also see a generator for `graphql`.

Yep, now run this command in the commandline:

```
rails g graphql:install
```

This generator will create a lot of things, including routes. Let's take a look at the routes file.


# Exploring the app, now that GraphQL has been enabled

```ruby
if Rails.env.development?
  mount GraphiQL::Rails::Engine, at: "/graphiql", graphql_path: "/graphql"
end
```

> This was automatically added by the `graphiql-rails` gem. When the app is in development, and the app is pointed to `/graphiql`, it'll follow the `/graphql` path. Pay attention to that little `i`. It matters.

Spin up the local server.

```
rails s
```

Open the browser; go to `localhost:3000/graphiql`

> That's the `graphiql` gui. Using that will happen soon.

We also have a new directory at `/app/graphql/`. Look at the contents. Those are:

1. `mutations/`
2. `types/`
3. `<name_of_your_app>_schema.rb`

Explore these as you see fit, or as your job/curiosity demands.

> Whats a type?

A Type, at a very high level, is a "type" of object.

> Say more about that...

In Rails, there are models....

> yes...

To turn those model objects into graphQL compliant things, they must become...

> graphQL Types

A `Type` is a graphQL way of taking a `Rails Model` and turning it into something that can be sent with graphQL

> What's a mutation?

A mutation is the type of graphQL request sent to MUTATE the data.

> POST, PUT, UPDATE, DELETE

# details about a `Type` in graphQL